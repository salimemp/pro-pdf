# Prometheus Configuration for PRO PDF
global:
  scrape_interval: 15s # Scrape metrics every 15 seconds
  evaluation_interval: 15s # Evaluate rules every 15 seconds
  external_labels:
    cluster: 'pro-pdf-production'
    environment: 'production'

# Remote write to Grafana Cloud
remote_write:
  - url: ${GRAFANA_CLOUD_PROMETHEUS_URL}
    basic_auth:
      username: ${GRAFANA_CLOUD_PROMETHEUS_USER}
      password: ${GRAFANA_CLOUD_API_KEY}
    queue_config:
      capacity: 10000
      max_shards: 5
      min_shards: 1
      max_samples_per_send: 5000
      batch_send_deadline: 5s
      min_backoff: 30ms
      max_backoff: 100ms

# Scrape configurations
scrape_configs:
  # PRO PDF Application Metrics
  - job_name: 'pro-pdf-app'
    scrape_interval: 15s
    metrics_path: '/api/metrics'
    static_configs:
      - targets: ['localhost:3000']
        labels:
          app: 'pro-pdf'
          service: 'web'

  # Health checks
  - job_name: 'pro-pdf-health'
    scrape_interval: 30s
    metrics_path: '/api/metrics/health'
    static_configs:
      - targets: ['localhost:3000']
        labels:
          app: 'pro-pdf'
          service: 'health'

  # Self-monitoring (Prometheus itself)
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
